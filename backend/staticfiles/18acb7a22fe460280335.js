(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{441:function(t,e,o){"use strict";o.r(e);o(29);var n=o(14),c={props:{showModal:Function},data:function(){return{categoryTitle:"",newCategory:!0,editCategoryId:null,categories:[],expiredNotices:[],noticePreview:{},newNotice:!1,notice:{id:null,city:{},office:{},department:{},category:{}},options:{cities:{options:[{value:null,text:"Select a City"}]},departments:{options:[{value:null,text:"Select a Department"}]},offices:{options:[{value:null,text:"Select an Office"}]},categories:{options:[{value:null,text:"Select a Category"}]}}}},methods:{showCatModal:function(t,data){this.newCategory=data.new,this.editCategoryId=data.catid,this.$refs.categorymodal.show(),this.newCategory||(this.categoryTitle=data.title)},handleCatOk:function(t){t.preventDefault(),this.handleCatSubmit()},handleCatSubmit:function(){var t=this,e=this.newCategory?this.$axios.$post:this.$axios.$put,data={};data.title=this.categoryTitle,this.newCategory||(data.id=this.editCategoryId),e("notices/category/",data,{headers:this.$store.getters.authHeader}).then((function(e){t.$refs.categorymodal.hide(),t.segregateNotices(e),t.categoryTitle="",t.newCategory&&(data.id=null)})).catch((function(t){return console.log(t)}))},deleteCategory:function(t,data){var e=this;if(this.categories.filter((function(t){return t.id===data.catid})).map((function(t){return 0===t.notice_categories.length}))[0]){var o=data.catid;this.$axios.$delete("notices/category/"+o+"/",{headers:this.$store.getters.authHeader}).then((function(t){return e.segregateNotices(t)})).catch((function(t){return console.log(t)}))}else alert("You can not delete a category with notices !!!")},updateCategory:function(t,data){var e=this,o=data.catid;this.$axios.$delete("notices/category/"+o+"/",{headers:this.$store.getters.authHeader}).then((function(t){return e.segregateNotices(t)})).catch((function(t){return console.log(t)}))},segregateNotices:function(t){var e=this;t.forEach((function(t){var o=t.notice_categories;t.notice_categories=[],e.expiredNotices=[],o.forEach((function(o){(new Date(o.expiry)<Date.now()?e.expiredNotices:t.notice_categories).push(o)}))})),this.categories=Object(n.a)(t)},getNotices:function(){var t=this;this.$axios.$get("notices/categories/",{headers:this.$store.getters.authHeader}).then((function(e){return t.segregateNotices(e)})).catch((function(t){return console.log(t)}))},deleteNotice:function(t,data){var e=this,o=data.noticeid;this.$axios.$delete("notices/notice/"+o+"/",{headers:this.$store.getters.authHeader}).then((function(t){return e.segregateNotices(t)})).catch((function(t){return console.log(t)}))},viewNotice:function(t,data){this.noticePreview={},this.$refs.noticeViewmodal.show(),this.noticePreview.title=data.notice.title,this.noticePreview.description=data.notice.description},initUpdate:function(){var t=this;this.options.cities.options=[{value:null,text:"Select a City"}],this.$axios.$get("accounts/cities/",{headers:this.$store.getters.authHeader}).then((function(e){e.forEach((function(e){t.options.cities.options.push({value:e.id,text:e.name})}))})).catch((function(t){return console.log(t)})),this.options.categories.options=[{value:null,text:"Select a Category"}],this.categories.forEach((function(e){t.options.categories.options.push({value:e.id,text:e.title})}))},onCityUpdate:function(){var t=this;this.options.offices.options=[{value:null,text:"Select an Office"}],this.options.departments.options=[{value:null,text:"Select a Department"}],this.$axios.$get("accounts/offices?city="+this.notice.city.value,{headers:this.$store.getters.authHeader}).then((function(e){e.forEach((function(e){t.options.offices.options.push({value:e.id,text:e.name})}))})).catch((function(t){return console.log(t)}))},onOfficeUpdate:function(){var t=this;this.options.departments.options=[{value:null,text:"Select a Department"}],this.$axios.$get("accounts/departments?office="+this.notice.office.value,{headers:this.$store.getters.authHeader}).then((function(e){e.forEach((function(e){t.options.departments.options.push({value:e.id,text:e.name})}))})).catch((function(t){return console.log(t)}))},handleNoticeOk:function(t){t.preventDefault(),this.handleNoticeSubmit()},noticeModal:function(t,data){var e=this;if(this.newNotice=data.new,this.newNotice)this.notice.city={},this.notice.office={},this.notice.department={},this.notice.title="",this.notice.description="",this.notice.expiry="";else{var o=data.notice;this.notice.id=o.id,this.notice.city={value:o.city,text:""},this.notice.office={value:o.office,text:""},this.notice.department={value:o.department,text:""},this.notice.title=o.title,this.notice.description=o.description,this.notice.expiry=o.expiry,this.$axios.$get("accounts/offices?city="+o.city,{headers:this.$store.getters.authHeader}).then((function(t){t.forEach((function(t){e.options.offices.options.push({id:t.id,text:t.name})}))})),this.$axios.$get("accounts/departments?office="+o.office,{headers:this.$store.getters.authHeader}).then((function(t){t.forEach((function(t){e.options.departments.options.push({id:t.id,text:t.name})}))}))}this.notice.category={value:data.notice.category,text:""},this.initUpdate(),this.$refs.noticeModal.show()},handleNoticeSubmit:function(){var t=this;(this.newNotice?this.$axios.$post:this.$axios.$put)("notices/notice/",{notice_data:this.notice},{headers:this.$store.getters.authHeader}).then((function(e){t.$refs.noticeModal.hide(),t.segregateNotices(e)})).catch((function(t){return console.log(t)}))}},mounted:function(){this.getNotices()}},r=o(28),component=Object(r.a)(c,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("b-container",{attrs:{fluid:""}},[o("H4",[t._v("NOTICES MANAGER \n        "),o("b-button",{staticClass:"mb-2 float-right",attrs:{variant:"success"},on:{click:function(e){return t.showCatModal(e,{catid:null,new:!0})}}},[t._v("New Category")])],1),t._v(" "),o("hr"),t._v(" "),o("b-row",t._l(t.categories,(function(e){return o("b-col",{key:e.id,staticClass:"mb-3",attrs:{md:"4"}},[o("b-card",{attrs:{"bg-variant":"light"},scopedSlots:t._u([{key:"header",fn:function(){return[o("span",{staticClass:"d-flex justify-content-between"},[o("h5",[t._v(t._s(e.title))]),t._v(" "),o("span",[o("a",{attrs:{href:"#"},on:{click:function(o){return o.stopPropagation(),o.preventDefault(),t.showCatModal(o,{catid:e.id,new:!1,title:e.title})}}},[o("font-awesome-icon",{attrs:{icon:"edit"}})],1),t._v("\n                            | \n                          "),o("a",{attrs:{href:"#"},on:{click:function(o){return o.stopPropagation(),o.preventDefault(),t.deleteCategory(o,{catid:e.id})}}},[o("font-awesome-icon",{attrs:{icon:"times"}})],1)])])]},proxy:!0},{key:"footer",fn:function(){return[o("span",[o("a",{attrs:{href:"#"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.noticeModal(e,{notice:t.notice,new:!0})}}},[t._v("+ Add Notice")])])]},proxy:!0}],null,!0)},[t._v(" "),t._l(e.notice_categories,(function(e){return o("b-card-text",{key:e.id,staticClass:"d-flex justify-content-between"},[o("span",[t._v(t._s(e.title))]),t._v(" "),o("span",[o("a",{attrs:{href:"#"},on:{click:function(o){return o.stopPropagation(),o.preventDefault(),t.noticeModal(o,{notice:e,new:!1})}}},[o("font-awesome-icon",{attrs:{icon:"edit"}})],1),t._v(" | \n                       "),o("a",{attrs:{href:"#"},on:{click:function(o){return o.stopPropagation(),o.preventDefault(),t.viewNotice(o,{notice:e})}}},[o("font-awesome-icon",{attrs:{icon:"eye"}})],1),t._v(" | \n                       "),o("a",{attrs:{href:"#"},on:{click:function(o){return o.stopPropagation(),o.preventDefault(),t.deleteNotice(o,{noticeid:e.id})}}},[o("font-awesome-icon",{attrs:{icon:"times"}})],1)])])}))],2)],1)})),1),t._v(" "),o("hr"),t._v(" "),o("b-container",{attrs:{fluid:""}},[o("b-card",{attrs:{"bg-variant":"warning",header:"Expired Notices"}},[o("b-row",t._l(t.expiredNotices,(function(e){return o("b-col",{key:e.id},[o("b-card-text",{staticClass:"d-flex justify-content-between bg-light mb-2 px-1"},[o("span",[t._v(t._s(e.title))]),t._v(" "),o("span",[o("a",{attrs:{href:"#"},on:{click:function(o){return o.stopPropagation(),o.preventDefault(),t.noticeModal(o,{notice:e,new:!1})}}},[o("font-awesome-icon",{attrs:{icon:"edit"}})],1),t._v(" | \n                            "),o("a",{attrs:{href:"#"},on:{click:function(o){return o.stopPropagation(),o.preventDefault(),t.viewNotice(o,{notice:e})}}},[o("font-awesome-icon",{attrs:{icon:"eye"}})],1),t._v(" | \n                            "),o("a",{attrs:{href:"#"},on:{click:function(o){return o.stopPropagation(),o.preventDefault(),t.deleteNotice(o,{noticeid:e.id})}}},[o("font-awesome-icon",{attrs:{icon:"times"}})],1)])])],1)})),1)],1)],1),t._v(" "),o("b-modal",{ref:"categorymodal",attrs:{title:"Category",size:"lg",centered:""},on:{ok:t.handleCatOk}},[o("b-form",{ref:"form",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleCatSubmit(e)}}},[o("b-row",[o("b-col",[o("b-form-group",{attrs:{id:"fieldset-horizontal","label-cols-sm":"3","label-cols-lg":"2","label-size":"sm",description:"Title",label:"Title","label-for":"category","invalid-feedback":"title is required"}},[o("b-form-input",{attrs:{id:"category",required:""},model:{value:t.categoryTitle,callback:function(e){t.categoryTitle=e},expression:"categoryTitle"}})],1)],1)],1),t._v(" "),t._t("default")],2)],1),t._v(" "),o("b-modal",{ref:"noticeViewmodal",attrs:{title:"Notice Preview",size:"lg",centered:""}},[o("h4",[t._v(t._s(t.noticePreview.title))]),t._v(" "),o("b-card-text",[t._v("\n            "+t._s(t.noticePreview.description)+"\n        ")])],1),t._v(" "),o("b-modal",{ref:"noticeModal",attrs:{title:"Notice Preview",size:"lg",centered:""},on:{ok:t.handleNoticeOk}},[o("b-card",{attrs:{"bg-variant":"light"}},[o("b-form",[o("b-row",[o("b-col",[o("b-form-group",{attrs:{id:"fieldset-horizontal","label-size":"sm",label:"title:","label-for":"title"}},[o("b-form-input",{attrs:{id:"title",size:"sm"},model:{value:t.notice.title,callback:function(e){t.$set(t.notice,"title",e)},expression:"notice.title"}})],1)],1),t._v(" "),o("b-col",[o("b-form-group",{attrs:{id:"fieldset-horizontal","label-size":"sm",label:"expiry:","label-for":"expiry"}},[o("b-form-input",{attrs:{id:"expiry",size:"sm"},model:{value:t.notice.expiry,callback:function(e){t.$set(t.notice,"expiry",e)},expression:"notice.expiry"}})],1)],1)],1),t._v(" "),o("b-row",[o("b-col",[o("b-form-group",{attrs:{id:"fieldset-horizontal","label-size":"sm",label:"City:","label-for":"city"}},[o("b-form-select",{ref:"city",attrs:{id:"city",options:t.options.cities.options,size:"sm"},on:{change:t.onCityUpdate},model:{value:t.notice.city.value,callback:function(e){t.$set(t.notice.city,"value",e)},expression:"notice.city.value"}})],1)],1),t._v(" "),o("b-col",[o("b-form-group",{attrs:{id:"fieldset-horizontal","label-size":"sm",label:"Office:","label-for":"office"}},[o("b-form-select",{ref:"office",attrs:{id:"office",options:t.options.offices.options,size:"sm"},on:{change:t.onOfficeUpdate},model:{value:t.notice.office.value,callback:function(e){t.$set(t.notice.office,"value",e)},expression:"notice.office.value"}})],1)],1),t._v(" "),null!=t.notice.office?o("b-col",[o("b-form-group",{attrs:{id:"fieldset-horizontal","label-size":"sm",label:"department:","label-for":"department"}},[o("b-form-select",{ref:"department",attrs:{id:"department",options:t.options.departments.options,size:"sm"},model:{value:t.notice.department.value,callback:function(e){t.$set(t.notice.department,"value",e)},expression:"notice.department.value"}})],1)],1):t._e()],1),t._v(" "),o("b-row",[o("b-col",[o("b-form-group",{attrs:{id:"fieldset-horizontal","label-cols-sm":"3","label-cols-lg":"2","label-size":"sm",label:"categories:","label-for":"categories"}},[o("b-form-select",{ref:"category",attrs:{id:"categories",options:t.options.categories.options,size:"sm"},model:{value:t.notice.category.value,callback:function(e){t.$set(t.notice.category,"value",e)},expression:"notice.category.value"}})],1)],1)],1),t._v(" "),o("b-row",[o("b-col",[o("b-form-group",{attrs:{id:"fieldset-horizontal","label-cols-sm":"3","label-cols-lg":"2","label-size":"sm",label:"description:","label-for":"description"}},[o("b-form-textarea",{ref:"description",attrs:{id:"description",size:"sm"},model:{value:t.notice.description,callback:function(e){t.$set(t.notice,"description",e)},expression:"notice.description"}})],1)],1)],1),t._v(" "),t._t("default")],2)],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports}}]);